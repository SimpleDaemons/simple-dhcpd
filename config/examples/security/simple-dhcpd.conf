{
  "dhcp": {
    "listen": ["0.0.0.0:67", "[::]:67"],
    "subnets": [
      {
        "name": "secure-corporate",
        "network": "10.0.1.0/24",
        "range": "10.0.1.100-10.0.1.200",
        "gateway": "10.0.1.1",
        "dns_servers": ["10.0.1.10", "10.0.1.11"],
        "domain_name": "secure.corp.local",
        "lease_time": 21600,
        "max_lease_time": 43200,
        "options": [
          {
            "name": "subnet-mask",
            "value": "255.255.255.0"
          },
          {
            "name": "routers",
            "value": "10.0.1.1"
          },
          {
            "name": "domain-name-servers",
            "value": "10.0.1.10,10.0.1.11"
          },
          {
            "name": "domain-name",
            "value": "secure.corp.local"
          }
        ],
        "reservations": [
          {
            "mac_address": "00:11:22:33:44:55",
            "ip_address": "10.0.1.10",
            "hostname": "dc1",
            "description": "Domain Controller 1",
            "vendor_class": "Windows"
          },
          {
            "mac_address": "00:11:22:33:44:56",
            "ip_address": "10.0.1.11",
            "hostname": "dc2",
            "description": "Domain Controller 2",
            "vendor_class": "Windows"
          }
        ],
        "exclusions": [
          {
            "start": "10.0.1.1",
            "end": "10.0.1.20"
          },
          {
            "start": "10.0.1.250",
            "end": "10.0.1.254"
          }
        ]
      }
    ],
    "global_options": [
      {
        "name": "domain-name-servers",
        "value": "10.0.1.10,10.0.1.11"
      },
      {
        "name": "ntp-servers",
        "value": "10.0.1.10,pool.ntp.org"
      }
    ],
    "security": {
      "enable": true,
      "dhcp_snooping": {
        "enabled": true,
        "trusted_interfaces": ["eth0"],
        "logging": true,
        "validation": true,
        "bindings": [
          {
            "mac_address": "00:11:22:33:44:55",
            "ip_address": "10.0.1.10",
            "interface": "eth0",
            "trusted": true
          }
        ]
      },
      "mac_filtering": {
        "enabled": true,
        "mode": "allow",
        "rules": [
          {
            "mac_address": "00:11:22:33:44:55",
            "allow": true,
            "description": "Domain Controller 1",
            "enabled": true
          },
          {
            "mac_address": "00:11:22:33:44:56",
            "allow": true,
            "description": "Domain Controller 2",
            "enabled": true
          },
          {
            "mac_address": "00:11:22:33:44:*",
            "allow": true,
            "description": "Corporate devices",
            "enabled": true
          },
          {
            "mac_address": "aa:bb:cc:dd:ee:*",
            "allow": false,
            "description": "Blocked vendor",
            "enabled": true
          }
        ]
      },
      "ip_filtering": {
        "enabled": true,
        "mode": "allow",
        "rules": [
          {
            "ip_address": "10.0.1.10",
            "allow": true,
            "description": "Domain Controller 1",
            "enabled": true
          },
          {
            "ip_address": "10.0.1.11",
            "allow": true,
            "description": "Domain Controller 2",
            "enabled": true
          },
          {
            "ip_address": "10.0.1.100",
            "allow": false,
            "description": "Blocked IP range start",
            "enabled": true
          }
        ]
      },
      "rate_limiting": {
        "enabled": true,
        "rules": [
          {
            "identifier": "*",
            "identifier_type": "mac",
            "max_requests": 50,
            "time_window": 60,
            "block_duration": 300,
            "enabled": true
          },
          {
            "identifier": "*",
            "identifier_type": "ip",
            "max_requests": 100,
            "time_window": 60,
            "block_duration": 300,
            "enabled": true
          },
          {
            "identifier": "00:11:22:33:44:55",
            "identifier_type": "mac",
            "max_requests": 200,
            "time_window": 60,
            "block_duration": 300,
            "enabled": true
          }
        ]
      },
      "option_82": {
        "enabled": true,
        "validation": true,
        "rules": [
          {
            "interface": "eth1",
            "required": true,
            "enabled": true
          },
          {
            "interface": "eth2",
            "required": false,
            "enabled": true
          }
        ],
        "trusted_relay_agents": [
          {
            "circuit_id": "circuit-001",
            "remote_id": "relay-001",
            "enabled": true
          },
          {
            "circuit_id": "circuit-002",
            "remote_id": "relay-002",
            "enabled": true
          }
        ]
      },
      "authentication": {
        "enabled": true,
        "key": "corporate-secret-key-2024",
        "client_credentials": [
          {
            "client_id": "00:11:22:33:44:55",
            "password_hash": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",
            "salt": "random-salt-001",
            "enabled": true
          },
          {
            "client_id": "00:11:22:33:44:56",
            "password_hash": "b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7",
            "salt": "random-salt-002",
            "enabled": true
          }
        ]
      },
      "security_events": {
        "enable_logging": true,
        "log_file": "/var/log/simple-dhcpd/security.log",
        "event_callback": null,
        "retention_days": 90,
        "alert_thresholds": {
          "rate_limit_exceeded": 10,
          "mac_filter_blocked": 5,
          "ip_filter_blocked": 5,
          "option_82_invalid": 3,
          "authentication_failed": 5
        }
      }
    },
    "logging": {
      "enable": true,
      "level": "info",
      "log_file": "/var/log/simple-dhcpd/dhcp.log",
      "security_log": "/var/log/simple-dhcpd/security.log",
      "format": "json",
      "rotation": true,
      "max_size": "100MB",
      "max_files": 30,
      "compression": true
    },
    "performance": {
      "max_leases": 5000,
      "lease_database": {
        "type": "sqlite",
        "path": "/var/lib/simple-dhcpd/leases.db",
        "backup": true,
        "backup_interval": 1800,
        "backup_retention": 30,
        "compression": true,
        "encryption": true
      }
    }
  }
}
